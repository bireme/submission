{% extends "submission/create.html" %}
{% load i18n %}
{% load custom_filters %}

{% block extrahead %}
    <script>
        var invalid_records_message = "{% trans "ERROR: Total records cannot be blank." %}";
        var invalid_bibliographic_type_message = "{% trans "ERROR: Bibliographic type cannot be blank." %}";
        var invalid_iso_file_message = "{% trans "ERROR: You need to put a ISO file." %}";
    </script>

    <script type="text/javascript" src="http://twitter.github.com/bootstrap/assets/js/bootstrap-tooltip.js"></script>
    <script type="text/javascript" src="http://twitter.github.com/bootstrap/assets/js/bootstrap-popover.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}/js/validate-submit-submission.js"></script>

    <script>
    $(function(){
        // tooltip
        $('a[data-toggle=tooltip]').tooltip();

        // popover   
        $('a[data-toggle=popover]').popover({
            html: true
        });
    })
    </script>

{% endblock %}

{% block "form" %}
    <form name="iso" onsubmit="return check_iso_form();" method="POST" class="form" action="{% url submission.views.create type.id %}" enctype="multipart/form-data">{% csrf_token %}
        {{ form.non_field_errors }}

        {% for field in form %}
            <div>

                <!-- errors -->
                {{ field.errors }}

                <!-- label -->
                {{ field.label_tag }}

                <!--  field -->
                {{ field }}

                <a href="#{{ field.html_name|add:"-help" }}" role="button" data-toggle="modal">
                    <i class="icon-question-sign"></i>
                </a>

                <!-- helper -->
                {# aqui foi feito um filtro que testa se existe o arquivo de helper, caso existir, ele mostra #}
                {% with "submission/helpers/"|add:field.html_name|add:".html" as helper %}
                    {% if helper|exists %}
                    <!-- Modal -->
                    <div id="{{ field.html_name|add:"-help" }}" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                            <h3 id="myModalLabel">{% trans "Help" %}</h3>
                        </div>
                            <div class="modal-body">
                            {% include helper %}  
                        </div>
                        <div class="modal-footer">
                            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                        </div>
                    </div>
                    {% endif %}
                {% endwith %}
            </div>
        {% endfor %}

        
        <div class="control-panel">
            <button type="submit" class="btn btn-large btn-primary">{% trans "Submit" %}</button>
        </div>
    </form>
{% endblock %}